# Simple Javascript secret sharing (splitting) with possible pen and paper fallback recovery
## Motivation
When considering security of private electronic assets like website accounts it is best practice to use two-factor authentication (2FA). However when using 2FA the weak point in the security setup often becomes the recovery process of the 2FA method.

Often email addresses are used for recovery but this just introduces the question of how one’s email is secured? Hopefully also with 2FA otherwise can you really consider your accounts 2FA protected if the recovery process circumvents 2FA? If your email is 2FA protected how is this 2FA recovered? If not email accounts are used for recovery often a phone number is used as recovery mechanism (or as the 2FA method itself). However with the existence of SIM swapping attacks this is most likely not a good choice. A better choice is storing recovery codes offline.

When storing such secrets there exists a privacy, robustness and utility trilemma. Secret sharing or secret splitting is a good option when storing secrets as otherwise privacy and robustness might not be sufficient. For example if you have your entire secret written in plain text on a single piece of paper a burglar could probably somewhat easily steal it. Whereas if your secret is split into multiple encrypted parts and stored in multiple locations then stealing the secret becomes much harder. Likewise some secret splitting schemes allow to recover the secret for example only with 3 of 5 secret parts. This increases the robustness of your secret storage so that even if some parts are lost you don’t lose your secret. 

However in our opinion utility is often lagging which might cause people to not even use secret sharing and sometimes just stick with insecure recovery methods like phone numbers. Also some secret sharing schemes are dependent on specific software or code libraries which might make the secret sharing scheme cumbersome to use.
## The repository
This repository is an attempt on creating a tool that can help make it simpler and safer to store recovery codes or other private secrets in a secure manner. The repository is a JavaScript implementation of Random Substitution Cipher chaining. Random Substitution Cipher can split a secret into two shares where each individual share doesn’t reveal the secret or parts of it. Random Substitution Cipher is a simple encryption scheme that use addition and subtraction to encrypt and decrypt the secret. Its simple nature makes it feasible to recover secrets with pen and paper as a fallback recovery method. This in turn makes the secret owner less dependent on the JavaScript code once a secret have been split into shares. The simple nature of the encryption also makes it trivial to validate the correctness of the secret shares.

When more than two shares are needed one of the shares are treated as a yet another secret and encrypted into two more shares bringing the total number of shares needed to recover the secret to three. This chaining process can be repeated until the desired number of shares have been reached. When decrypting the process happens in reverse which therefore requires all the issued shares to reveal the secret. However to increase robustness multiple recovery share sets are created such that for example any 3 of 5 participants can always combine shares an recover the secret. But as the number of possible recovery sets grows exponentially when the number of participants increases one should probably consider using another secret sharing method if a large number of participants are required. But for a smaller number of participants which should probably be sufficient for storing private secrets like 2FA recovery codes it seems that the project has found a good balance between privacy, robustness and utility.

This code repository (“https://github.com/splitkeyseed/secretsharing”) includes the core mechanisms for splitting a secret into encrypted shares and recovering the secret again (if not pen and paper is used for recovery).

There also exists a proprietary web app (that is not licensed under the same license as the repository) where the secret sharing scheme can be utilized. The web app can be launched from “https://splitkeyseed.github.io/secretsharing” but is hosted and launched from an external resource.

The project is a prototype and is in a pre-release (fragile) state. The code has not been thoroughly tested and must be considered insecure and not exempt from errors. As such, any input data cannot be guaranteed to remain private, we strongly recommend not to input any sensitive or valuable data and only use the code when permanently offline and disconnected from any network and any insecure or online devices.

Also, the secret sharing encryption mechanism is not guaranteed to be secure or correct. For example the app may not be using sufficient randomness which is critical in regards to security. You should always verify that the mechanism’s secret shares can recover the secret in full and in general verify that the mechanism is sufficient for your use. Furthermore be advised that reuse of secret shares must be avoided as reuse can significantly compromise the security of the mechanism.

Copyright © 2023 Github.com User: "splitkeyseed". All rights reserved.
